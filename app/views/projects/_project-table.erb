<tr>
  <td><%= project.project_name %></td>
  <td><%= Course.find(project.course_id).course_name %></td>
  <td>
    <a class="btn btn-primary" data-bs-toggle="collapse" href=<%= "\#showEval#{counter}" %> role="button">
      Show Evaluations
    </a>
  </td>
  <td>
    <%= link_to 'Delete Project', project, class:"btn btn-primary", role:"button", method: :delete, data: { confirm: 'Are you sure?' } %>
  </td>
</tr>
<%# Show Evaluations of student %>
<tr >
  <td colspan="4">
    <div class="collapse" id=<%= "showEval#{counter}" %>>
      <div class="card card-body">
        <table class="table table-light table-striped table-bordered rounded text-center">
          <tr>
            <th>Team</th>
            <th>For Student</th>
            <th>Score</th>
            <th>Comment</th>
            <th>By Student</th>
          </tr>
          <% Team.all.each do |team| %>
            <%# this team is assigned the project %>
            <% if team.project_id == project.id%>
              <tr>
                <% num_student_in_team = team.students.length %>
                <% num_evaluation_for_team = team.evaluations.length %>
                <%# n student in team. m evaluations %>
                <% team_rowspan = num_student_in_team + num_evaluation_for_team %>
                <td rowspan=<%= team_rowspan + 1 %>><%= Team.find(project.team_id).team_name %></td>
                <% team.students.each do |student| %>
                  <tr>
                    <%# n-1 evaluations for each student %>
                    <td rowspan=<%= num_student_in_team %>>Evaluations for <%= student.user.name %></td>
                    <% team.evaluations.each do |evaluation| %>
                      <% if evaluation.for_student == student.id %>
                        <tr>
                          <td><%= evaluation.score %></td>
                          <td><%= evaluation.comment %></td>
                          <td>By <%= Student.find(evaluation.by_student).user.name %></td>
                        </tr>
                      <% end %>
                    <% end %>
                  </tr>
                <% end %>
              </tr>
            <% end %>
          <% end %>
        </table>
      </div>
    </div>
  </td>
</tr>
